Clear-Host; New-Item -ItemType "directory" encoded 2>&1>$null; Get-ChildItem *.mkv| ForEach-Object {Write-Host "Starting $($_.Name)`n"; cmd /k "vspipe ToG.vpy --arg `"src_path=$($_.Name)`" -y - | ffmpeg -y -hide_banner -loglevel warning -stats -i pipe: -i `"$($_.Name)`" -map 0:v -map 1:a:0 -pix_fmt yuv420p10le -c:v libx265 -preset slow -x265-params `"rc-lookahead=90:aq-strength=0.8:psy-rd=1:psy-rdoq=1:aq-mode=3:qcomp=0.60:ref=6:bframes=8:frame-threads=1:crf=18:limit-sao:no-strong-intra-smoothing:deblock=0,0`" -c:a libopus -b:a 128k -ac 2 -c:s copy `"encoded\$($_.BaseName).mkv`" & exit"; Write-Host "`n----------------`n"}